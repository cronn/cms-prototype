---
import { getEntries, type CollectionEntry } from "astro:content";
import FormattedDate from "../FormattedDate.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCurrentLocale, getLocalizedData } from "../../i18n/utils";

type Props = CollectionEntry<"blog">["data"];

const { title, authors, ogTitle, ogDescription, pubDate, titleImage } =
  Astro.props;

const currentLocale = getCurrentLocale(Astro.currentLocale);
const { blog } = getLocalizedData({ currentLocale });
const postAuthors = await getEntries(authors);
---

<BaseLayout title={ogTitle} description={ogDescription} image={titleImage}>
  <article class="prose text-lg">
    <div class="mx-auto">
      {titleImage && <img width={1020} height={510} src={titleImage} alt="" />}
    </div>
    <div>
      <div>
        <div>
          <FormattedDate date={pubDate} />
        </div>
        <h1>{title}</h1>
        <h2 class="text-lg text-gray-500">
          {blog.authors}: {
            postAuthors.map((author) => author.data.name).join(", ")
          }
        </h2>
        <hr />
      </div>
      <slot />
    </div>
  </article>
</BaseLayout>
